
drop table CUSTOMERS CASCADE CONSTRAINTS; 
drop table PRODUCTS CASCADE CONSTRAINTS; 
drop table SALES CASCADE CONSTRAINTS; 

CREATE TABLE MYSTUDENTS (
"DNI" NUMBER(9,0) PRIMARY KEY,
"NAME" VARCHAR2(20 BYTE),
"SURNAME1" VARCHAR2(20 BYTE),
"SURNAME2" VARCHAR2(20 BYTE),
"GENDER" VARCHAR2(4 BYTE),
"EMAIL" VARCHAR2(40 BYTE),
"BIRTHDATE" DATE,
"ENROLMENT_DATE" DATE
);

INSERT INTO MYSTUDENTS
SELECT DNI, A.NOMBRE, APELLIDO1, APELLIDO2, GENERO, EMAIL, FECHA_NACIMIENTO, FECHA_PRIM_MATRICULA 
FROM DOCENCIA.alumnos a join DOCENCIA.provincia p 
on a.cpro = p.codigo
where p.nombre = 'MÃ¡laga';

UPDATE MYSTUDENTS
set NAME = upper(NAME), 
    SURNAME1 = upper (SURNAME1),
    SURNAME2 = upper (SURNAME2);
    
CREATE TABLE MYENROLL AS SELECT * FROM DOCENCIA.MATRICULAR;

DELETE FROM MYENROLL WHERE ALUMNO NOT IN (SELECT DNI FROM MYSTUDENTS);

INSERT INTO MYENROLL()